version: "3"

tasks:
  desc: "start the project (for web-development only)"
  start:
    cmds:
      - npm run dev

  # Note: Only executed by devops team.
  buildprod:
    desc: "build the production version of the project"
    cmds:
      # Build the project
      - npm run build:prod

      # Checkout prod branch in the target repo
      - git -C ../../../comiccoin-publicfaucet-static checkout -B prod

      # Copy build files (Next.js generates the "out" directory by default for static exports)
      - cp -Rf ./out/* ../../../comiccoin-publicfaucet-static

      # Remove build directory
      - rm -Rf ./out

      # Commit and push changes
      - git -C ../../../comiccoin-publicfaucet-static add --all
      - git -C ../../../comiccoin-publicfaucet-static commit -m 'Latest production deployment.'
      - git -C ../../../comiccoin-publicfaucet-static push origin prod
